\begin{Interfaz}


\textbf{se explica con}: \tadNombre{Mapa}.

\textbf{g\'eneros}: \TipoVariable{map}.

\Title{Operaciones b\'asicas de Mapa}


\InterfazFuncion{crearMapa}{}{map}%
{$res \igobs crearMapa$}%
[$O(1)$]
[genera una mapa vac\'io.]


\InterfazFuncion{agregarCoor}{ \In{c}{coord}, \Inout{m}{map}}{}
[$m_0 \igobs m \land \lnot posExistente(c, m_0) $]  
{$m \igobs agregarCoor(c, m_0)$}
[$O(  max(latitud(c), longitud(c), tam(m))^4  )$]
[agrega la coordenada \texttt{c} al mapa \texttt{m}]


\InterfazFuncion{coordenadas}{\In{m}{map}}{$conj(coord)$}%
{$res \igobs coordenadas(m)$}%
[$O(tam(m))$]  % Algoritmo: recorro la diagonal principal
[devuelve el conjunto de todas las coordenadas de m.]


\InterfazFuncion{posExistente}{ \In{c}{coord}, \In{m}{map}}{bool}
{$res \igobs posExistente(c, m)$}
[$O(1)$]
[verifica si la coordenada \texttt{c} existe en el mapa \texttt{m}]


\InterfazFuncion{hayCamino}{ \In{c_1}{coord}, \In{c_2}{coord}, \In{m}{map}}{bool}
[$posExistente(c_1, m) \land posExistente(c_2, m) $]
{$res \igobs hayCamino(c_1, c_2, m)$}
[$O(1)$]
[verifica si existe una forma de llegar desde \texttt{$c_1$} a \texttt{$c_2$}]


\Title{Especificacion de auxiliares usadas en la interfaz}
  
\begin{tad}{\tadNombre{Mapa Extension}}
\tadExtiende{\tadNombre{Mapa}}

\tadTitulo{Otras operaciones}{}

\tadOperacion{tam}{mapa/$m$}{nat}{}
\tadOperacion{max}{nat/$x$, nat/$y$}{nat}{}
\tadOperacion{maxLatitud}{conj(coor)/$cs$}{nat}{$\neg \emptyset ?(cs)$}
\tadOperacion{maxLongitud}{conj(coor)/$cs$}{nat}{$\neg \emptyset ?(cs)$}

\tadAxioma{tam(mapa)}
{
\IF
$\#$(coordenadas(mapa)) = 0
THEN
0
ELSE
max(maxLatitud(coordenadas(mapa)), maxLongitud(coordenadas(mapa)))
FI
}

\tadAxioma{max(x ,y)}{\IF x $\geq$ y THEN x ELSE y FI}

\tadAxioma{maxLatitud(cs)}
{
\IF
$\#cs = 1$
THEN
latitud(dameUno(cs))
ELSE
{
\IF latitud(dameUno(cs)) $\geq$ maxLatitud(sinUno(cs))
THEN
damUno(cs)
ELSE
maxLatitud(sinUno(cs))
FI
}
FI}


\tadAxioma{maxLongitud(cs)}
{
\IF
$\#cs = 1$
THEN
longitud(dameUno(cs))
ELSE
{
\IF longitud(dameUno(cs)) $\geq$ maxLongitud(sinUno(cs))
THEN
damUno(cs)
ELSE
maxLongitud(sinUno(cs))
FI
}
FI}


\end{tad}



\end{Interfaz}


\begin{Representacion}

\begin{Estructura}{mapa}[map]
	\begin{Tupla}[map]  
		\tupItem{tam}{nat}
		\tupItem{grilla}{vector(vector(vector(vector(bool)))}  
  	\end{Tupla}
  	
\end{Estructura}

\RepFc[]{true}



  

  \AbsFc[]{}

\end{Representacion}

\begin{Algoritmos}


% crearMapa
\begin{algorithm}[H]
{\textbf{iCrearMapa}()$\to$ $res$ : map}
\begin{algorithmic}[1]
   
  							% Como digo que aca va un vector(vector(v.... vacio? 	
\State $res \gets  \langle 0 , Vacio() \rangle $     COMO SABER QUE VACIO ES UN VECTOR?  \Comment Crear vector vacio es O(1) // $O(1)$

\medskip
\Statex \underline{Complejidad:} $O(1)$

\end{algorithmic}
\end{algorithm}

% coordenadas
\begin{algorithm}[H]
{\textbf{iCoordenadas}(\In{m}{map})$\to$ $res$ : conj(coor)}
\begin{algorithmic}[1]
   
 
\State $res \gets Vacio() $     COMO SABER QUE VACIO ES UN CTO?  \Comment Crear conjunto vacio es O(1) // $O(1)$

\For{$i=0$ to $tam(m)$}
	
	\For{$j=0$ to $tam(m)$}
		
		\If{iPosExistente(i, j)}  \Comment $O(1)$
			
			\State $c \gets NuevaCoor(i, j) $  \Comment $O(1)$			
			\State $Agregar(res, c) $  \Comment $O(log(\#res))$			
			
		\EndIf
		
	\EndFor

\EndFor


\medskip
\Statex \underline{Complejidad:} $O(log(tam(m))*(tam(m))^2)$

\Statex \underline{Justificacion:} Son dos for anidados, por cada iteracion externa, se ejecutan $tam(m)$ iteraciones internas. En total son $(tam(m))^2$ iteraciones. En cada una de ellas, puede ejecutarse el $Agregar(rec, c)$ con complejidad $O(log(\#res))$. $res$ solo contiene coordenadas recorridas por la iteracion, por lo que $\#res <= tam(m)$, es decir $O(log(\#res)) = O(log(tam(m)))$, por lo que la complejidad final es $O(log(tam(m))*(tam(m))^2)$.

\end{algorithmic}
\end{algorithm}

% posExistente

% EXPLICACION:
% CUANDO AGREGO UNA COORDENADA, LA CONECTO EN LA GRILLA CONSIGO MISMA, SIGNIFICANDO QUE EXISTE 
\begin{algorithm}[H]
{\textbf{iPosExistente}(\In{m}{map}, \In{c}{coor})$\to$ $res$ : bool}
\begin{algorithmic}[1]
   

\If{latitud(c) $>=$ tam(m) OR longitud(c) $>=$ tam(m)}
	\State $res \gets false$ \Comment $O(1)$
\Else
	\State $x \gets latitud(c)$ \Comment $O(1)$
	\State $y \gets longitud(c)$ \Comment $O(1)$
	\State $res \gets m.grilla[x][y][x][y]$ \Comment $O(1)$
\EndIf


\medskip
\Statex \underline{Complejidad:} $O(1)$


\end{algorithmic}
\end{algorithm}

% hayCamino

\begin{algorithm}[H]
{\textbf{iHayCamino}(\In{m}{map}, \In {c1}{coor}, \In{c2}{coor})$\to$ $res$ : bool}
\begin{algorithmic}[1]

\State $res \gets grills[latitud(c1)][longitud(c1)][latitud(c2)][longitud(c1)]$ \Comment $O(1)$

\medskip
\Statex \underline{Complejidad:} $O(1)$


\end{algorithmic}
\end{algorithm}


% agregaCoor


%\begin{algorithm}[H]
{\textbf{iAgregaCoor}(\Inout{m}{map}, \In {c}{coor})}
\begin{algorithmic}[1]

\State $maximo \gets max(latitud(c), longitud(c)) $ \Comment $O(1)$

% Si hay una coordenada mayor al maximo
\State \If{maximo $>$ m.tam} \Comment $O(1)$

\State $nGrilla = iCrearGrilla(maximo)$ \Comment $O(maximo^4)$
\State $iCopiarCoordenadas(nGrilla, m.grilla)$ \Comment $O((maximo^4)$
\State $m.grilla = nGrilla$ \Comment $O(maximo^4)$
\State $m.tam = maximo$ \Comment $O(1)$

\EndIf

% La marco consigo misma para decir que la cooordenada existe
\State $m.grilla[latitud(c)][longitud(c)][latitud(c)][longitud(c)] = true$ \Comment $O(1)$
\State $ $

% Creo una grilla de visitadas, todas false
%Vector vacio ver como escribirlo bien
\State $visitados \gets Vacio() $ \Comment $O(1)$
\For{$i = 0$ to $m.tam$}	    \Comment $O(infinito)$
\State $visitadosAux \gets Vacio() $ \Comment $O(1)$	
\For{$j = 0$ to $m.tam$}      \Comment $O(Inifinito)$
\State $visitadosAux.AgregarAtras(false)$ \Comment $O(1)$
\EndFor
\State $visitados.AgregarAtras(visitadosAux)$ \Comment $O(1)$
\EndFor


% aRecorrer es una cola..
\State $aRecorrer \gets Vacio() $ \Comment $O(1)$
\State $aRecorrer.Encolar(c)$ \Comment $O(1)$

\State $ $

\While{$\neg aRecorrer.EsVacia()$}    \Comment Como maximo se recorren todas las coordenadas del mapa // $O((m.tam)^2)$

\State $act \gets Proximo(aRecorrer)$ \Comment Obtener el proximo de la cola es O(1) // $O(1)$
\State $Desencolar(aRecorrer)$ \Comment Eliminar el proximo de la cola es O(1) // $O(1)$

\State $ $


% Reviso la coordenada de la izquierda
\If{$latitud(act) > 0$}      \Comment $O(1)$
\State $tmpX = latitud(coordenadaALaIzquierda(act))$   \Comment $O(1)$
\State $tmpY = longitud(coordenadaALaIzquierda(act))$  \Comment $O(1)$
\If{$\neg visitados[tmpX][tmpY]$}    \Comment $O(1)$
\State $visitados[tmpX][tmpY] = true$    \Comment $O(1)$
	\If{$Existe(coordenadaALaIzquierda(act))$} 	\Comment $O(1)$
		\State $m.Grilla[latitud(c)][longitud(c)][tmpX][tmpY] = true$ \Comment $O(1)$
	\EndIf
\EndIf
\EndIf

\State $ $

\If{$longitud(act) > 0$}      \Comment $O(1)$
\State $tmpX = latitud(coordenadaAbajo(act))$   \Comment $O(1)$
\State $tmpY = longitud(coordenadaAbajo(act))$  \Comment $O(1)$
\If{$\neg visitados[tmpX][tmpY]$}    \Comment $O(1)$
\State $visitados[tmpX][tmpY] = true$    \Comment $O(1)$
	\If{$Existe(coordenadaAbajo(act))$} 	\Comment $O(1)$
		\State $m.Grilla[latitud(c)][longitud(c)][tmpX][tmpY] = true$ \Comment $O(1)$
	\EndIf
\EndIf
\EndIf

\State $ $


\If{$latitud(act) < m.Tam-1$}      \Comment $O(1)$
\State $tmpX = latitud(coordenadaALaDerecha(act))$   \Comment $O(1)$
\State $tmpY = longitud(coordenadaALaDerecha(act))$  \Comment $O(1)$
\If{$\neg visitados[tmpX][tmpY]$}    \Comment $O(1)$
\State $visitados[tmpX][tmpY] = true$    \Comment $O(1)$
	\If{$Existe(coordenadaALaDerecha(act))$} 	\Comment $O(1)$
		\State $m.Grilla[latitud(c)][longitud(c)][tmpX][tmpY] = true$ \Comment $O(1)$
	\EndIf
\EndIf
\EndIf

\State $ $

\If{$longitud(act) < m.Tam-1$}      \Comment $O(1)$
\State $tmpX = latitud(coordenadaArriba(act))$   \Comment $O(1)$
\State $tmpY = longitud(coordenadaArriba(act))$  \Comment $O(1)$
\If{$\neg visitados[tmpX][tmpY]$}    \Comment $O(1)$
\State $visitados[tmpX][tmpY] = true$    \Comment $O(1)$
	\If{$Existe(coordenadaArriba(act))$} 	\Comment $O(1)$
		\State $m.Grilla[latitud(c)][longitud(c)][tmpX][tmpY] = true$ \Comment $O(1)$
	\EndIf
\EndIf
\EndIf


\EndWhile

\medskip
\Statex \underline{Complejidad:} $O((max(latitud(c), longitud(c), m.tam))^4)$
\Statex \underline{Justificacion:} Trabajo con matrices de 4 dimensiones, en peor caso hay que redimensionar, en donde se recorren todos los elementos. VER COMO JUSTIFICAR MEJOR


\end{algorithmic}
%\end{algorithm}


% tam

\begin{algorithm}[H]
{\textbf{iTam}(\In{m}{map})$\to$ $res$ : nat}
\begin{algorithmic}[1]

\State $res \gets m.tam$ \Comment $O(1)$

\medskip
\Statex \underline{Complejidad:} $O(1)$

\end{algorithmic}
\end{algorithm}


  
\end{Algoritmos}